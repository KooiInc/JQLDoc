<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>JQLLog.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-JQL.html">JQL</a><ul class='methods'><li data-type='method'><a href="module-JQL.html#~ExtendedNodeList">ExtendedNodeList</a></li><li data-type='method'><a href="module-JQL.html#~JQL/allowUnknownHtmlTags">JQL/allowUnknownHtmlTags</a></li><li data-type='method'><a href="module-JQL.html#~JQL/debugLog">JQL/debugLog</a></li><li data-type='method'><a href="module-JQL.html#~JQL/insertPositions">JQL/insertPositions</a></li><li data-type='method'><a href="module-JQL.html#~JQL/log">JQL/log</a></li><li data-type='method'><a href="module-JQL.html#~JQL/logElementCreationErrors">JQL/logElementCreationErrors</a></li><li data-type='method'><a href="module-JQL.html#~JQL/node">JQL/node</a></li><li data-type='method'><a href="module-JQL.html#~JQL/nodes">JQL/nodes</a></li><li data-type='method'><a href="module-JQL.html#~JQL/popup">JQL/popup</a></li><li data-type='method'><a href="module-JQL.html#~JQL/setStyle">JQL/setStyle</a></li><li data-type='method'><a href="module-JQL.html#~JQL/setStyling4Log">JQL/setStyling4Log</a></li><li data-type='method'><a href="module-JQL.html#~JQL/setSystemLogActiveState">JQL/setSystemLogActiveState</a></li><li data-type='method'><a href="module-JQL.html#~JQL/setTagPermission">JQL/setTagPermission</a></li><li data-type='method'><a href="module-JQL.html#~JQL/time">JQL/time</a></li><li data-type='method'><a href="module-JQL.html#~JQL/virtual">JQL/virtual</a></li><li data-type='method'><a href="module-JQL.html#~text">text</a></li></ul></li><li><a href="module-JQL_JQLLog.html">JQL/JQLLog</a><ul class='methods'><li data-type='method'><a href="module-JQL_JQLLog.html#.reversed">reversed</a></li><li data-type='method'><a href="module-JQL_JQLLog.html#.toConsole">toConsole</a></li><li data-type='method'><a href="module-JQL_JQLLog.html#~Log">Log</a></li><li data-type='method'><a href="module-JQL_JQLLog.html#~setStyling4Log">setStyling4Log</a></li></ul></li><li><a href="module-JQL_JQLMethods.html">JQL/JQLMethods</a><ul class='methods'><li data-type='method'><a href="module-JQL_JQLMethods.html#.addClass">addClass</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.append">append</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.appendTo">appendTo</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.assignAttrValues">assignAttrValues</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.attr">attr</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.computedStyle">computedStyle</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.css">css</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.dimensions">dimensions</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.duplicate">duplicate</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.each">each</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.empty">empty</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.find">find</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.find$">find$</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.first">first</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.first$">first$</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.getData">getData</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.hasClass">hasClass</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.hide">hide</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.html">html</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.htmlFor">htmlFor</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.is">is</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.isEmpty">isEmpty</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.on">on</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.ON">ON</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.outerHtml">outerHtml</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.parent">parent</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.prepend">prepend</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.prependTo">prependTo</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.prop">prop</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.remove">remove</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.removeAttr">removeAttr</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.removeClass">removeClass</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.replace">replace</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.replaceClass">replaceClass</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.replaceMe">replaceMe</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.setData">setData</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.show">show</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.single">single</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.style">style</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.text">text</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.toDOM">toDOM</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.toggleAttr">toggleAttr</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.toggleClass">toggleClass</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.toggleStyleFragments">toggleStyleFragments</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.toNodeList">toNodeList</a></li><li data-type='method'><a href="module-JQL_JQLMethods.html#.val">val</a></li></ul></li><li><a href="module-JQL_Popup.html">JQL/Popup</a><ul class='methods'><li data-type='method'><a href="module-JQL_Popup.html#.popupFactory">popupFactory</a></li><li data-type='method'><a href="module-JQL_Popup.html#~create">create</a></li><li data-type='method'><a href="module-JQL_Popup.html#~createTimed">createTimed</a></li><li data-type='method'><a href="module-JQL_Popup.html#~remove">remove</a></li><li data-type='method'><a href="module-JQL_Popup.html#~removeModal">removeModal</a></li></ul></li><li><a href="module-JQL_XHelpers_Attributes.html">JQL/XHelpers/Attributes</a></li><li><a href="module-JQL_XHelpers_DOM.html">JQL/XHelpers/DOM</a><ul class='methods'><li data-type='method'><a href="module-JQL_XHelpers_DOM.html#~createElementFromHtmlString">createElementFromHtmlString</a></li><li data-type='method'><a href="module-JQL_XHelpers_DOM.html#~element2DOM">element2DOM</a></li></ul></li><li><a href="module-JQL_XHelpers_ExtensionHelpers.html">JQL/XHelpers/ExtensionHelpers</a><ul class='methods'><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~hex2Full">hex2Full</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~hex2RGBA">hex2RGBA</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~initializePrototype">initializePrototype</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~isObjectAndNotArray">isObjectAndNotArray</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~isVisible">isVisible</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~loop">loop</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~time">time</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~toDashedNotation">toDashedNotation</a></li><li data-type='method'><a href="module-JQL_XHelpers_ExtensionHelpers.html#~truncateHtmlStr">truncateHtmlStr</a></li></ul></li><li><a href="module-JQL_XHelpers_HandlerFactory.html">JQL/XHelpers/HandlerFactory</a><ul class='methods'><li data-type='method'><a href="module-JQL_XHelpers_HandlerFactory.html#~addListenerIfNotExisting">addListenerIfNotExisting</a></li><li data-type='method'><a href="module-JQL_XHelpers_HandlerFactory.html#~createHandlerForHID">createHandlerForHID</a></li><li data-type='method'><a href="module-JQL_XHelpers_HandlerFactory.html#~metaHandler">metaHandler</a></li></ul></li><li><a href="module-JQL_XHelpers_HtmlCleanup.html">JQL/XHelpers/HtmlCleanup</a><ul class='methods'><li data-type='method'><a href="module-JQL_XHelpers_HtmlCleanup.html#~logElementCreationErrors">logElementCreationErrors</a></li><li data-type='method'><a href="module-JQL_XHelpers_HtmlCleanup.html#~setTagPermission">setTagPermission</a></li></ul></li><li><a href="module-JQL_XHelpers_HtmlTags.html">JQL/XHelpers/HtmlTags</a><ul class='methods'><li data-type='method'><a href="module-JQL_XHelpers_HtmlTags.html#.isAllowed">isAllowed</a></li><li data-type='method'><a href="module-JQL_XHelpers_HtmlTags.html#~setTagPermission">setTagPermission</a></li></ul></li><li><a href="module-JQL_XHelpers_Styling.html">JQL/XHelpers/Styling</a><ul class='methods'><li data-type='method'><a href="module-JQL_XHelpers_Styling.html#~changeCssStyleRule">changeCssStyleRule</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">JQLLog.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// noinspection JSAnnotator

/**
 * A small module for logging in a fixed positioned JQLLog box
 * &lt;br>Every line logged is preceded by the time it is logged (granularity: milliseconds)
 * The styling of the logbox happens via a &lt;code>&amp;lt;style>&lt;/code> element, added to the
 * header of the enclosing document.
 * @module JQL/JQLLog
 */
import {createElementFromHtmlString, element2DOM, insertPositions} from "./DOM.js";
import {setStyle, customStylesheet} from "./Styling.js";
import {time, isVisible} from "./JQLExtensionHelpers.js";
/**
 * Some utility methods for logging
 * @inner {Object.&lt;key, Function|boolean>} debugLog
 * @property {function} debugLog.isVisible Is the JQLLog box visible?
 * @property {function} debugLog.on Activate logging for JQL.
 * @property {function} debugLog.off Deactivate logging for JQL.
 * @property {function} debugLog.remove Deactivate logging for JQL and remove &lt;code>div#logBox&lt;/code>.
 * @property {function} debugLog.hide Hide the JQLLog box.
 * @property {function} debugLog.show Show the JQLLog box.
 * @property {function} debugLog.toConsole Log to console.
 * @property {function} debugLog.reversed Log top to bottom or latest first.
 * @property {function} debugLog.clear the log box.
 * @property {boolean} debugLog.isOn (getter) is logging on?
 */
const debugLog = {
  get isOn() { return useLogging; },
  isVisible: () => isVisible(logBox()),
  on() {
    useLogging = true;
    if (!log2Console) {
      const box = logBox() || createLogElement();
      box?.parentNode["classList"].add(`visible`);
    }
    Log(`Logging started (to ${log2Console ? `console` : `document`})`);
  },
  off() {
    if (logBox()) {
      Log(`Logging stopped`);
      logBox()?.parentNode.classList.remove(`visible`);
    }
    useLogging = false;
  },
  /**
   * Log everything to the browser console
   * &lt;br>Exposed as: &lt;code>debugLog.toConsole&lt;/code>
   * &lt;br>&lt;b>Note&lt;/b>: this possibly destroys an alreay created
   * &lt;code>div#logBox&lt;/code> in the document if set to true.
   * @memberof module:JQL/JQLLog
   * @param console {boolean} log to browser console (true) or not (false, default)
   */
  toConsole(console = false) {
    log2Console = console;
    useLogging = console;
    console &amp;&amp; document.querySelector(`#logBox`)?.remove();
  },
  remove: () => {
    useLogging = false;
    document.querySelector(`#logBox`).remove();
  },
  hide: () => logBox()?.parentNode.classList.remove(`visible`),
  show: () => logBox()?.parentNode.classList.add(`visible`),
  /**
   * Change direction of log entries
   * &lt;br>Exposed as: &lt;code>debugLog.reversed&lt;/code>
   * @memberof module:JQL/JQLLog
   * @param reverse {boolean} latest last (false) or latest first (true) (default true)
   */
  reversed(reverse = true) {
    reverseLogging = reverse;
    Log(`Reverse logging reset: now logging ${
      reverse ? `bottom to top (latest first)` : `top to bottom (latest last)`}`);
  },
  clear() {
    const box = logBox();
    box &amp;&amp; (box.textContent = ``);
    Log(`Cleared`);
  }
};

/**
 * The default styling to use for the logbox. This is used by [setStyling4Log]{@link module:JQL/JQLLog~setStyling4Log}.
 * @const {Object.&lt;string, Object.&lt;string, string|number>>} stylingDefault4Log
 * @memberof module:JQL/JQLLog
 */
let stylingDefault4Log = {
  "#logBox": {
    minWidth: `0px`,
    maxWidth: `0px`,
    minHeight: `0px`,
    maxHeight: `0px`,
    width: `0`,
    height: `0`,
    zIndex: -1,
    border: `none`,
    padding: `0px`,
    overflow: `hidden`,
    transition: `all 0.3s ease`,
    position: `fixed`,
  },
  "#logBox.visible": {
    backgroundColor: `rgb(255, 255, 224)`,
    zIndex: 1,
    position: `static`,
    border: `1px dotted rgb(153, 153, 153)`,
    maxWidth: `33vw`,
    minWidth: `30vw`,
    minHeight: `10vh`,
    maxHeight: `90vh`,
    overflow: `auto`,
    width: `50vw`,
    height: `20vh`,
    margin: `1rem 0px`,
    padding: `0px 8px 19px`,
    resize: `both`,
  },
  "@media screen and (min-width: 320px) and (max-width: 1024px)": {
    mediaSelectors: {
      "#logBox.visible": {
        maxWidth: `90vw`,
        width: `90vw`,
        resize: `none` },
    }
  },
  "#logBox .legend": {
    textAlign: `center`,
    position: `absolute`,
    marginTop: `-1em`,
    width: `inherit`,
    maxWidth: `inherit`,
  },
  "#logBox .legend div": {
    textAlign: `center`,
    display: `inline-block`,
    maxWidth: `inherit`,
    height: `1.2rem`,
    backgroundColor: `rgb(119, 119, 119)`,
    padding: `2px 10px`,
    color: `rgb(255, 255, 255)`,
    boxShadow: `rgb(119 119 119) 2px 1px 10px`,
    borderRadius: `4px`,
  },
  "#logBox .legend div:before": {
    content: `"JQL Logging"`,
  },
  "#logBox #jql_logger": {
    marginTop: `0.7rem`,
    lineHeight: `1.4em`,
    fontFamily: `consolas, monospace`,
    whiteSpace: `pre-wrap`,
    maxWidth: `inherit`,
  }
};
let useLogging = false;
let log2Console = false;
let reverseLogging = true;
let logBox = () => document.querySelector(`#jql_logger`);

/**
 * Add style classes for the JQLLog box to a custom css style element.
 * @param styles {Object} style rules Object, e.g. &lt;code>&amp;#123;margin: `0`, color: `green`&amp;#125;&lt;/code>.
 * Default styles are in &lt;code>stylingDefault4Log&lt;/code>.
 */
const setStyling4Log = (styles = stylingDefault4Log) =>
  Object.entries(styles).forEach(([selector, style]) => setStyle(selector, style, customStylesheet.id));

let useHtml = true;

const createLogElement = () => {
  setStyling4Log();
  const jql_logger_element = useHtml ? `div` : `pre`;
  const loggingFieldSet = `
    &lt;div id="logBox">
      &lt;div class="legend">
        &lt;div>&lt;/div>
      &lt;/div>
      &lt;${jql_logger_element} id="jql_logger">&lt;/${jql_logger_element}>
    &lt;/div>`;
  element2DOM(createElementFromHtmlString(loggingFieldSet), undefined, insertPositions.AfterBegin);
  return document.querySelector(`#jql_logger`);
};

const decodeForConsole = something => something.constructor === String &amp;&amp;
  Object.assign(document.createElement(`textarea`), {innerHTML: something}).textContent ||
  something;

/**
 * Create JQLLog entry/entries, preceded with the time of logging (millisecond granularity).
 * &lt;br>If the local [useLogging] boolean is false, nothing is logged
 * &lt;br> in JQL exposed as &lt;code>JQL.log&lt;/code>
 * @param args {...(string|Object)} string(s) or Object(s) to print in the JQLLog box
 * &lt;br>&lt;b>Note&lt;/b> Objects are converted to JSON representation
 */
const Log = (...args) => {
    if (!useLogging) { return; }
    if (!log2Console &amp;&amp; !logBox()) {
      createLogElement();
    }
    const logLine = arg => `${arg instanceof Object ? JSON.stringify(arg, null, 2) : arg}\n`;
    args.forEach( arg => log2Console
      ? console.log(decodeForConsole(arg))
      : logBox().insertAdjacentHTML(
          reverseLogging ? `afterbegin` : `beforeend`,
          `${time()} ${logLine(arg.replace(/\n/g, `&lt;br>`))}`)
    );
};

export { Log, debugLog, setStyling4Log };</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sun Dec 05 2021 22:09:37 GMT+0100 (Midden-Europese standaardtijd) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
