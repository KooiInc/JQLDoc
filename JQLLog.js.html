<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>JQLLog.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-Attributes.html">Attributes</a></li><li><a href="module-DOM.html">DOM</a><ul class='methods'><li data-type='method'><a href="module-DOM.html#~createElementFromHtmlString">createElementFromHtmlString</a></li><li data-type='method'><a href="module-DOM.html#~element2DOM">element2DOM</a></li></ul></li><li><a href="module-HandlerFactory.html">HandlerFactory</a><ul class='methods'><li data-type='method'><a href="module-HandlerFactory.html#~addListenerIfNotExisting">addListenerIfNotExisting</a></li><li data-type='method'><a href="module-HandlerFactory.html#~createHandlerForHID">createHandlerForHID</a></li><li data-type='method'><a href="module-HandlerFactory.html#~metaHandler">metaHandler</a></li></ul></li><li><a href="module-Helpers.html">Helpers</a><ul class='methods'><li data-type='method'><a href="module-Helpers.html#~createRegExp">createRegExp</a></li><li data-type='method'><a href="module-Helpers.html#~frequencies">frequencies</a></li><li data-type='method'><a href="module-Helpers.html#~groupDigits">groupDigits</a></li><li data-type='method'><a href="module-Helpers.html#~hasDuplicatesForKeys">hasDuplicatesForKeys</a></li><li data-type='method'><a href="module-Helpers.html#~isEven">isEven</a></li><li data-type='method'><a href="module-Helpers.html#~isObjectAndNotArray">isObjectAndNotArray</a></li><li data-type='method'><a href="module-Helpers.html#~repeat">repeat</a></li><li data-type='method'><a href="module-Helpers.html#~time">time</a></li><li data-type='method'><a href="module-Helpers.html#~time2Fragments">time2Fragments</a></li><li data-type='method'><a href="module-Helpers.html#~toDashedNotation">toDashedNotation</a></li><li data-type='method'><a href="module-Helpers.html#~toUndashedNotation">toUndashedNotation</a></li><li data-type='method'><a href="module-Helpers.html#~truncateHtmlStr">truncateHtmlStr</a></li></ul></li><li><a href="module-HtmlCleanup.html">HtmlCleanup</a><ul class='methods'><li data-type='method'><a href="module-HtmlCleanup.html#~logElementCreationErrors">logElementCreationErrors</a></li><li data-type='method'><a href="module-HtmlCleanup.html#~setTagPermission">setTagPermission</a></li></ul></li><li><a href="module-HtmlTags.html">HtmlTags</a><ul class='methods'><li data-type='method'><a href="module-HtmlTags.html#.isAllowed">isAllowed</a></li><li data-type='method'><a href="module-HtmlTags.html#~setTagPermission">setTagPermission</a></li></ul></li><li><a href="module-JQL.html">JQL</a><ul class='methods'><li data-type='method'><a href="module-JQL.html#~ExtendedNodeList">ExtendedNodeList</a></li><li data-type='method'><a href="module-JQL.html#~node">node</a></li><li data-type='method'><a href="module-JQL.html#~nodes">nodes</a></li><li data-type='method'><a href="module-JQL.html#~setStyle">setStyle</a></li><li data-type='method'><a href="module-JQL.html#~setSystemLogActiveState">setSystemLogActiveState</a></li><li data-type='method'><a href="module-JQL.html#~virtual">virtual</a></li></ul></li><li><a href="module-JQLCollectionExtensions.html">JQLCollectionExtensions</a><ul class='methods'><li data-type='method'><a href="module-JQLCollectionExtensions.html#~addClass">addClass</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~assignAttrValues">assignAttrValues</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~attr">attr</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~clear">clear</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~css">css</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~empty">empty</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~hide">hide</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~remove">remove</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~removeAttr">removeAttr</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~removeClass">removeClass</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~replaceClass">replaceClass</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~setData">setData</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~show">show</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~styleInline">styleInline</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~toggleAttr">toggleAttr</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~toggleClass">toggleClass</a></li><li data-type='method'><a href="module-JQLCollectionExtensions.html#~toggleStyleFragments">toggleStyleFragments</a></li></ul></li><li><a href="module-JQLExtensionHelpers.html">JQLExtensionHelpers</a><ul class='methods'><li data-type='method'><a href="module-JQLExtensionHelpers.html#~getAllDataAttributeValues">getAllDataAttributeValues</a></li><li data-type='method'><a href="module-JQLExtensionHelpers.html#~hex2Full">hex2Full</a></li><li data-type='method'><a href="module-JQLExtensionHelpers.html#~hex2RGBA">hex2RGBA</a></li><li data-type='method'><a href="module-JQLExtensionHelpers.html#~initializePrototype">initializePrototype</a></li><li data-type='method'><a href="module-JQLExtensionHelpers.html#~isVisible">isVisible</a></li><li data-type='method'><a href="module-JQLExtensionHelpers.html#~loop">loop</a></li></ul></li><li><a href="module-JQLExtensions.html">JQLExtensions</a><ul class='methods'><li data-type='method'><a href="module-JQLExtensions.html#~append">append</a></li><li data-type='method'><a href="module-JQLExtensions.html#~appendTo">appendTo</a></li><li data-type='method'><a href="module-JQLExtensions.html#~delegate">delegate</a></li><li data-type='method'><a href="module-JQLExtensions.html#~each">each</a></li><li data-type='method'><a href="module-JQLExtensions.html#~find">find</a></li><li data-type='method'><a href="module-JQLExtensions.html#~find$">find$</a></li><li data-type='method'><a href="module-JQLExtensions.html#~first">first</a></li><li data-type='method'><a href="module-JQLExtensions.html#~first$">first$</a></li><li data-type='method'><a href="module-JQLExtensions.html#~getData">getData</a></li><li data-type='method'><a href="module-JQLExtensions.html#~hasClass">hasClass</a></li><li data-type='method'><a href="module-JQLExtensions.html#~html">html</a></li><li data-type='method'><a href="module-JQLExtensions.html#~htmlFor">htmlFor</a></li><li data-type='method'><a href="module-JQLExtensions.html#~insert">insert</a></li><li data-type='method'><a href="module-JQLExtensions.html#~is">is</a></li><li data-type='method'><a href="module-JQLExtensions.html#~isEmpty">isEmpty</a></li><li data-type='method'><a href="module-JQLExtensions.html#~on">on</a></li><li data-type='method'><a href="module-JQLExtensions.html#~ON">ON</a></li><li data-type='method'><a href="module-JQLExtensions.html#~outerHtml">outerHtml</a></li><li data-type='method'><a href="module-JQLExtensions.html#~parent">parent</a></li><li data-type='method'><a href="module-JQLExtensions.html#~prop">prop</a></li><li data-type='method'><a href="module-JQLExtensions.html#~replace">replace</a></li><li data-type='method'><a href="module-JQLExtensions.html#~replaceMe">replaceMe</a></li><li data-type='method'><a href="module-JQLExtensions.html#~single">single</a></li><li data-type='method'><a href="module-JQLExtensions.html#~text">text</a></li><li data-type='method'><a href="module-JQLExtensions.html#~val">val</a></li></ul></li><li><a href="module-JQLLog.html">JQLLog</a><ul class='methods'><li data-type='method'><a href="module-JQLLog.html#.debugLog%255Breversed%255D">debugLog[reversed]</a></li><li data-type='method'><a href="module-JQLLog.html#.debugLog%255BtoConsole%255D">debugLog[toConsole]</a></li><li data-type='method'><a href="module-JQLLog.html#~Log">Log</a></li><li data-type='method'><a href="module-JQLLog.html#~setStyling4Log">setStyling4Log</a></li></ul></li><li><a href="module-Styling.html">Styling</a><ul class='methods'><li data-type='method'><a href="module-Styling.html#~changeCssStyleRule">changeCssStyleRule</a></li></ul></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">JQLLog.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// noinspection JSValidateJSDoc,JSUnresolvedVariable,JSUnusedGlobalSymbols

/**
 * A small module for logging in a fixed positioned JQLLog box
 * &lt;br>Every line logged is preceded by the time it is logged (granularity: milliseconds)
 * The styling of the logbox happens via a &lt;code>&amp;lt;style>&lt;/code> element, added to the
 * header of the enclosing document.
 * @module JQLLog
 */
import {createElementFromHtmlString, element2DOM, insertPositions } from "./DOM.js";
import {setStyle, customStylesheet} from "./Styling.js";
import {time} from "./Helpers.js";
import {isVisible} from "./JQLExtensionHelpers.js";

/**
 * Helpers for logging
 * @type {object}
 * @name debugLog
 * @property {function} debugLog.isVisible Is the JQLLog box visible?
 * @property {function} debugLog.on Activate logging for JQL.
 * @property {function} debugLog.off Deactivate logging for JQL.
 * @property {function} debugLog.remove Deactivate logging for JQL and remove &lt;code>div#logBox&lt;/code>.
 * @property {function} debugLog.hide Hide the JQLLog box.
 * @property {function} debugLog.show Show the JQLLog box.
 * @property {function} debugLog.toConsole Log to console
 *  (see &lt;a href="#.debugLog%255BtoConsole%255D">debugLog[toConsole]&lt;/a>).
 * @property {function} debugLog.reversed Log top to bottom or latest first
 *  (see &lt;a href="#.debugLog%255Breversed%255D">debugLog[reversed]&lt;/a>).
 * @property {function} debugLog.clear the log box.
 * @property {boolean} debugLog.isOn (getter) is logging on?
 */
const debugLog = {
  get isOn() { return useLogging; },
  isVisible: () => logBox &amp;&amp; isVisible(logBox),
  on() {
    useLogging = true;
    if (!log2Console) {
      logBox = document.querySelector("#jql_logger") || createLogElement();
      logBox.parentNode.classList.add(`visible`);
    }
    Log(`Logging started (to ${log2Console ? `console` : `document`})`);
  },
  off() {
    if (logBox) {
      Log(`Logging stopped`);
      logBox &amp;&amp; logBox.parentNode.classList.remove(`visible`);
    }
    useLogging = false;
  },
  /**
   * Log everything to the browser console
   * &lt;br>Exposed as: &lt;code>debugLog.toConsole&lt;/code>
   * &lt;br>&lt;b>Note&lt;/b>: this possibly destroys an alreay created
   * &lt;code>div#logBox&lt;/code> in the document if set to true.
   * @static
   * @method debugLog[toConsole]
   * @param console {boolean} log to browser console (true) or not (false, default)
   */
  toConsole(console = false) {
    log2Console = console;
    useLogging = console;
    console &amp;&amp; logBox &amp;&amp; logBox.parentNode.remove();
  },
  remove: () => {
    useLogging = false;
    document.querySelector(`#logBox`).remove();
  },
  hide: () => logBox &amp;&amp; logBox.parentNode.classList.remove(`visible`),
  show: () => logBox &amp;&amp; logBox.parentNode.classList.add(`visible`),
  /**
   * Change direction of log entries
   * &lt;br>Exposed as: &lt;code>debugLog.reversed&lt;/code>
   * @static
   * @method debugLog[reversed]
   * @param reverse {boolean} latest last (false) or latest first (true) (default true)
   */
  reversed(reverse = true) {
    reverseLogging = reverse;
    Log(`Reverse logging reset: now logging ${
      reverse ? `bottom to top (latest first)` : `top to bottom (latest last)`}`);
  },
  clear() {
    if (logBox) {
      logBox.textContent = ``;
      Log(`Cleared`);
    }
  }
};

let stylingDefault4Log = {
  "#logBox": {
    minWidth: `0px`,
    maxWidth: `0px`,
    minHeight: `0px`,
    maxHeight: `0px`,
    opacity: `0`,
    border: `none`,
    padding: `0px`,
    overflow: `hidden`,
    transition: `all 1s ease 0s`,
    position: `fixed`,
  },
  "#logBox.visible": {
    backgroundColor: `rgb(255, 255, 224)`,
    position: `static`,
    opacity: `1`,
    border: `1px dotted rgb(153, 153, 153)`,
    maxWidth: `90vw`,
    minWidth: `30vw`,
    minHeight: `10vh`,
    maxHeight: `90vh`,
    overflow: `auto`,
    width: `50vw`,
    height: `20vh`,
    margin: `1rem 0px`,
    padding: `0px 8px 19px`,
    resize: `both`,
  },
  "#logBox .legend": {
    textAlign: `center`,
    position: `absolute`,
    marginTop: `-1em`,
    width: `inherit`,
  },
  "#logBox .legend div": {
    textAlign: `center`,
    display: `inline-block`,
    width: `auto`,
    height: `1.2rem`,
    backgroundColor: `rgb(119, 119, 119)`,
    padding: `2px 10px`,
    color: `rgb(255, 255, 255)`,
    boxShadow: `rgb(119 119 119) 2px 1px 10px`,
    borderRadius: `4px`,
  },
  "#logBox .legend div:before": {
    content: `"JQL Logging"`,
  },
  "#logBox #jql_logger": {
    lineHeight: `1.4em`,
    fontFamily: `consolas, monospace`,
  }
};
let useLogging = false;
let log2Console = false;
let reverseLogging = true;
let logBox = undefined;
/**
 * Add style classes for the JQLLog box to a custom css style element.
 * @param styles {Object} style rules Object, e.g. &lt;code>&amp;#123;margin: `0`, color: `green`&amp;#125;&lt;/code>.
 * Default styles are in &lt;code>stylingDefault4Log&lt;/code>
 * header of the document in which JQL is used). Default is 'JQLCustomCSS'.
 */
const setStyling4Log = (styles = stylingDefault4Log) =>
  Object.entries(styles).forEach(([selector, style]) => setStyle(selector, style, customStylesheet.id));

let useHtml = false;

const createLogElement = () => {
  setStyling4Log();
  const jql_logger_element = useHtml ? `div` : `pre`;
  const loggingFieldSet = `
    &lt;div id="logBox">
      &lt;div class="legend">
        &lt;div>&lt;/div>
      &lt;/div>
      &lt;${jql_logger_element} id="jql_logger">&lt;/${jql_logger_element}>
    &lt;/div>`;
  element2DOM(createElementFromHtmlString(loggingFieldSet), undefined, insertPositions.AfterBegin);
  return document.querySelector(`#jql_logger`);
};

const decodeForConsole = something => something.constructor === String &amp;&amp;
  Object.assign(document.createElement(`textarea`), {innerHTML: something}).textContent ||
  something;

/**
 * Create JQLLog entry/entries, preceded with the time of logging (millisecond granularity).
 * &lt;br>If the local [useLogging] boolean is false, nothing is logged
 * &lt;br> in JQL exposed as &lt;code>JQL.log&lt;/code>
 * @param args {...(string|Object)} string(s) or Object(s) to print in the JQLLog box
 * &lt;br>&lt;b>Note&lt;/b> Objects are converted to JSON representation
 */
const Log = (...args) => {
    if (!useLogging) { return; }
    if (!log2Console &amp;&amp; !logBox) {
      createLogElement();
    }
    const logLine = arg => `${arg instanceof Object ? JSON.stringify(arg, null, 2) : arg}\n`;
    args.forEach( arg => log2Console
      ? console.log(decodeForConsole(arg))
      : logBox.insertAdjacentHTML(
          reverseLogging ? `afterbegin` : `beforeend`,
          `${time()} ${logLine(arg.replace(/\n/g, `&lt;br>`))}`)
    );
};

const setStylingId4Log = id => defaultStylingId = id;
export { Log, debugLog, setStyling4Log };</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.7</a> on Sat Nov 20 2021 17:19:02 GMT+0100 (Midden-Europese standaardtijd) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>



</body>
</html>
